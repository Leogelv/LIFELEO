# Документация раздела задач

## Общее описание
Раздел задач позволяет управлять повседневными задачами и делами. Каждая задача может иметь подзадачи, заметки, категории и дедлайны.

## Основные возможности

### 1. Управление задачами
- Создание новых задач
- Редактирование существующих задач
- Удаление задач
- Отметка задач как выполненных/невыполненных
- Быстрое продление дедлайна (+1 час, +1 день)
- Выполнение и автоматическое пересоздание задачи
- Подсветка просроченных задач

### 2. Подзадачи
- Добавление подзадач к основной задаче
- Отметка подзадач как выполненных/невыполненных
- Отслеживание прогресса выполнения подзадач

### 3. Заметки
- Добавление форматированных заметок к задачам с помощью rich text editor
- Поддержка базового форматирования текста (жирный, курсив, списки и т.д.)

### 4. Категории
- Вода
- Спорт
- Медитация
- Работа
- Музыка
- Быт
- Финансы

### 5. Отображение
- Вертикальный список
- Горизонтальный список (карточки)
- Фильтрация по статусу выполнения (показать/скрыть выполненные)
- Визуальное выделение просроченных задач

## Технические детали

### Структура данных задачи
```typescript
interface Todo {
  id: string
  name: string
  done: boolean
  created_at: string
  deadline: string
  telegram_id: number
  notes?: string
  repeat_type?: 'daily' | 'weekly' | 'monthly'
  repeat_ends?: string
  is_habit: boolean
  category?: string
  tags?: string[]
}
```

### Структура данных подзадачи
```typescript
interface Subtask {
  id: string
  todo_id: string
  name: string
  done: boolean
  created_at: string
}
```

## Компоненты

### TodoList
Основной компонент для отображения списка задач. Отвечает за:
- Загрузку задач из базы данных
- Фильтрацию и сортировку
- Управление отображением (вертикальный/горизонтальный список)
- Обработку действий с задачами
- Автоматическое обновление при изменениях

### TodoCard
Компонент для отображения отдельной задачи. Показывает:
- Название задачи
- Статус выполнения
- Категорию с цветовой индикацией
- Дедлайн с подсветкой просроченных задач
- Наличие заметки
- Количество подзадач и их статус
- Тип повторения (если есть)

Функции быстрого доступа:
- Отметка о выполнении
- Продление дедлайна на час
- Продление дедлайна на день
- Выполнение и автоматическое пересоздание
- Удаление задачи

### EditTodoModal
Модальное окно для редактирования задачи. Позволяет изменять:
- Название
- Заметку (с помощью rich text editor)
- Дедлайн
- Категорию
- Управлять подзадачами
- Настройки повторения

### RichTextEditor
Компонент для редактирования форматированного текста заметок. Поддерживает:
- Базовое форматирование текста
- Списки
- Заголовки
- Цитаты

## База данных
Задачи и связанные с ними данные хранятся в следующих таблицах:
- `todos` - основная таблица задач
- `subtasks` - таблица подзадач

Подробная структура таблиц описана в файле `DB_STRUCTURE.md`. 